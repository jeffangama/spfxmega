{"version":3,"sources":["webpack:///../webpack/bootstrap 1ce3d533db60f205ebe8","webpack:///../../../../src/extensions/spfxToastr/SpfxToastrApplicationCustomizer.ts","webpack:///../external \"@microsoft/decorators\"","webpack:///../external \"@microsoft/sp-core-library\"","webpack:///../external \"@microsoft/sp-application-base\"","webpack:///../external \"@microsoft/sp-loader\"","webpack:///../../../../src/extensions/spfxToastr/MISMain.ts","webpack:///../../../../src/extensions/spfxToastr/MISGlobalNavigation.ts","webpack:///../external \"jquery\"","webpack:///../external \"sp-init\"","webpack:///../external \"microsoft-ajax\"","webpack:///../external \"sp-runtime\"","webpack:///../external \"sharepoint\""],"names":[],"mappings":"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","file":"spfx-toastr-application-customizer.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 1ce3d533db60f205ebe8","import { override } from '@microsoft/decorators';\nimport { Log } from '@microsoft/sp-core-library';\nimport {\n  BaseApplicationCustomizer,\n  PlaceholderContent,\n  PlaceholderName\n} from '@microsoft/sp-application-base';\nimport { IWebPartContext } from '@microsoft/sp-webpart-base';\nimport * as strings from 'SpfxToastrApplicationCustomizerStrings';\n//Needed to reference external CSS files\nimport { SPComponentLoader } from '@microsoft/sp-loader';\n\nimport { MISMain } from './MISMain';\nimport * as $ from 'jquery';\n\n// import * as toastr from 'toastr';\n// import styles from './SpfxToastr.module.scss';\n//import { IToast, ToastService } from '../../services/toastService'; //loaded from the toastService barrel - temporarily disabled due to issue with WebPack\nimport { IToast } from '../../services/toastService/IToast';\nimport { ToastService } from '../../services/toastService/ToastService';\n\nconst LOG_SOURCE: string = 'SpfxToastrApplicationCustomizer';\n\nrequire('sp-init');\nrequire('microsoft-ajax');\nrequire('sp-runtime');\nrequire('sharepoint');\n\nSPComponentLoader.loadCss('https://samavangarde.sharepoint.com/sites/devjeff/Style%20Library/MIS.GlobalNavigation/css/MIS.GlobalNavigationModern.css')\n/**\n * If your command set uses the ClientSideComponentProperties JSON input,\n * it will be deserialized into the BaseExtension.properties object.\n * You can define an interface to describe it.\n */\nexport interface ISpfxToastrApplicationCustomizerProperties {\n  Top: string;\n  Bottom: string;\n}\n\n//SPComponentLoader.loadCss('https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css');\n\n/** A Custom Action which can be run during execution of a Client Side Application */\nexport default class SpfxToastrApplicationCustomizer\n  extends BaseApplicationCustomizer<ISpfxToastrApplicationCustomizerProperties> {\n\n  private toastsPromise: Promise<IToast[]>;\n\n  private _headerPlaceholder: PlaceholderContent;\n  private _topPlaceholder: PlaceholderContent | undefined;\n  private _bottomPlaceholder: PlaceholderContent | undefined;\n\n  @override\n  public onInit(): Promise<void> {\n    //Log.info(LOG_SOURCE, `Initialized v1.0.4 ${strings.Title}`);\n\n    Log.info(LOG_SOURCE, `After changedEvent`);\n\n    // Call render method for generating the HTML elements.\n    //this._renderPlaceHolders();\n\n\n    // Added to handle possible changes on the existence of placeholders.\n    this.context.placeholderProvider.changedEvent.add(this, this._renderPlaceHolders);\n\n\n    Log.info(LOG_SOURCE, `After _renderPlaceHolders`);\n    //Dialog.alert(`hello from SPFX`);\n    return Promise.resolve<void>();\n  }\n\n  private buildMegaMenu(): void {\n\n    //$('.ms-bgColor-themeDark').text(\"tete\");\n\n    $(document).ready(function () {\n      //alert(\"test\");\n    });\n\n    let instanceMis: MISMain = new MISMain(this.context);\n\n    // const context: SP.ClientContext = new SP.ClientContext(this.context.pageContext.web.absoluteUrl);\n    // const web: SP.Web = context.get_web();\n    // context.load(web);\n    // context.executeQueryAsync(function name(sender, args) {\n    //   //this.webpartTitle = web.get_title();\n    //   //console.log(web.get_description());\n    //   // let siteContent: string = `<div>\n    //   //                            <h2>Title: ${web.get_title()}</h2>\n    //   //                            <span>Description: ${web.get_description()}<span>\n    //   //                          </div>`;\n    //   //htmlContext.domElement.querySelector(\"#siteContent\").innerHTML =siteContent;\n    // },\n    //   function (sender, args) {\n    //     console.log(args.get_message());\n    //   });\n\n  }\n  private _renderPlaceHolders(): void {\n\n    console.log('HelloWorldApplicationCustomizer._renderPlaceHolders()');\n    console.log('Available placeholders: ',\n      this.context.placeholderProvider.placeholderNames.map(name => PlaceholderName[name]).join(', '));\n\n    // Handling the top placeholder\n    if (!this._topPlaceholder) {\n      this._topPlaceholder =\n        this.context.placeholderProvider.tryCreateContent(\n          PlaceholderName.Top,\n          { onDispose: this._onDispose });\n\n      // The extension should not assume that the expected placeholder is available.\n      if (!this._topPlaceholder) {\n        console.error('The expected placeholder (Top) was not found.');\n        return;\n      }\n\n      if (this.properties) {\n        let topString: string = this.properties.Top;\n        if (!topString) {\n          topString = '(Top property was not defined.)';\n        }\n\n        if (this._topPlaceholder.domElement) {\n          this._topPlaceholder.domElement.innerHTML = `<div id=\"MEGAMENU\" class=\"MEGAMENU\"></div>`;\n\n          // this._topPlaceholder.domElement.innerHTML = `\n          // <div id=\"MEGAMENU\" class=\"\">\n          //   <div class=\"ms-bgColor-themeDark ms-fontColor-white \">\n          //     This is my place holder\n\n          //     // <i class=\"ms-Icon ms-Icon--Info\" aria-hidden=\"true\"></i>\n          //   </div>\n          // </div>`;\n        }\n      }\n    }\n\n    this._loadSPJSOMScripts().then(() => {\n\n      this.buildMegaMenu();\n    })\n  }\n\n  private _onDispose(): void {\n    console.log('[HelloWorldApplicationCustomizer._onDispose] Disposed custom top and bottom placeholders.');\n  }\n\n  public getSiteCollectionUrl(): string {\n    let baseUrl = window.location.protocol + \"//\" + window.location.host;\n    const pathname = window.location.pathname;\n    const siteCollectionDetector = \"/sites/\";\n    if (pathname.indexOf(siteCollectionDetector) >= 0) {\n      baseUrl += pathname.substring(0, pathname.indexOf(\"/\", siteCollectionDetector.length));\n    }\n    return baseUrl;\n  }\n\n  private _loadSPJSOMScripts(): Promise<void> {\n    return new Promise<void>((resolve, reject) => {\n      const siteColUrl = this.getSiteCollectionUrl();\n      try {\n        SPComponentLoader.loadScript(siteColUrl + '/_layouts/15/init.js', {\n          globalExportsName: '$_global_init'\n        })\n          .then((): Promise<void> => {\n            return SPComponentLoader.loadScript(siteColUrl + '/_layouts/15/MicrosoftAjax.js', {\n              globalExportsName: 'Sys'\n            });\n          })\n          .then((): Promise<void> => {\n            return SPComponentLoader.loadScript(siteColUrl + '/_layouts/15/SP.Runtime.js', {\n              globalExportsName: 'SP'\n            });\n          })\n          .then((): Promise<void> => {\n            return SPComponentLoader.loadScript(siteColUrl + '/_layouts/15/SP.js', {\n              globalExportsName: 'SP'\n            });\n          })\n          .then((): Promise<void> => {\n            return SPComponentLoader.loadScript(siteColUrl + '/_layouts/15/SP.taxonomy.js', {\n              globalExportsName: 'SP'\n            });\n          })\n          .then((): void => {\n            //this.setState({ loadingScripts: false });\n            resolve();\n          })\n          .catch((reason: any) => {\n            resolve();\n            //this.setState({ loadingScripts: false, errors: [...this.state.errors, reason] });\n          });\n      } catch (error) {\n        //this.setState({ loadingScripts: false, errors: [...this.state.errors, error] });\n      }\n    });\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/extensions/spfxToastr/SpfxToastrApplicationCustomizer.ts","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@microsoft/decorators\"\n// module id = 1\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@microsoft/sp-core-library\"\n// module id = 2\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@microsoft/sp-application-base\"\n// module id = 3\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@microsoft/sp-loader\"\n// module id = 4\n// module chunks = 0","import { SPHttpClient, SPHttpClientResponse } from '@microsoft/sp-http';\nimport { MISGlobalNavigation } from './MISGlobalNavigation';\n\nexport class MISMain {\n\n  public listGUID: any;\n  public navigationType: any; //'Menu' or 'Wiki'\n  public termStoreGUID: any; // = _termStoreGUID,\n  public termStoreName: any; // = _termStoreName,//Service de métadonnées gérées\n  public homeBtnTitle: any;\n  public homeBtnUrl: any;\n  public isCentralResource: any;\n  public spcontext: any;\n\n  constructor(_spcontext: any) {\n    this.spcontext = _spcontext;\n    this.listGUID = null;\n    this.navigationType = null;\n    this.termStoreGUID = null;\n    this.termStoreName = null;\n    this.homeBtnTitle = null;\n    this.homeBtnUrl = null;\n    this.isCentralResource = null;\n\n    try {\n      //Contain the webapp where mysites is configured\n      var privateUrl = \"https://private.monacoinformatiqueservice.mc\";\n      this.getMenuParameters();\n      //SP.SOD.executeOrDelayUntilScriptLoaded(MIS.SiteCollection.execute, \"sp.ui.pub.ribbon.js\");\n    } catch (ex) {\n      //console.log(\"$(document).ready\" + ex);\n      if (typeof console === \"object\") {\n        console.log(\"$(document).ready\" + ex);\n      } else {\n        alert(\"$(document).ready\" + ex);\n      }\n    }\n  }\n\n  //public static init(spcontext: any, _termStoreName: any, _termStoreGUID: any) {\n  private getMenuParameters(): void {\n    console.log(\"getMenuParameters called\");\n\n    try {\n      this.loadSessionStorage;\n      if (this.termStoreGUID == undefined && this.termStoreName == undefined) {\n        //var url = _spPageContextInfo.webAbsoluteUrl;\n        var url = (this.spcontext.pageContext.web.absoluteUrl == \"/\") ? \"\" : this.spcontext.pageContext.web.absoluteUrl;\n        //debugger\n        this.getSettingsData(url).then(() => {\n          //debugger\n          console.log(\"then getSettingsData\");\n          console.log(\"isCentralresource value \" + this.isCentralResource);\n          console.log(\"termStoreName value \" + this.termStoreName);\n\n          //Insert the menu in the top navigation\n          this.insertMenu();\n\n          //if (this.isCentralResource == true && url != this.homeBtnUrl) {\n          //  this.getSettingsData(this.homeBtnUrl); //Call GlobalNavigation settings data in the Central ressource url\n          //}\n        }); //Call GlobalNavigation settings data\n      }\n    } catch (e) {\n      if (typeof console === \"object\") {\n        console.log(\"getMenuParameters function:\" + e);\n      }\n    }\n  }\n  /**\n   * Load data from List GlobalNavigation URL and update the sessionStorage\n   *\n   */\n  private getSettingsData(url): Promise<void> {\n\n    return new Promise<void>((resolve, reject) => {\n\n      console.log(\"gettingsData function called\");\n\n      try {\n        var requestUri = url + \"/_api/web/lists/getByTitle('GlobalNavigation')/Items?$filter=isActif eq 1\";\n        console.log(requestUri);\n        // execute AJAX request synchrone\n\n        let thisGlobal = this;\n        //debugger\n        $.ajax({\n          url: requestUri,\n          type: \"GET\",\n          headers: {\n            \"ACCEPT\": \"application/json;odata=verbose\"\n          },\n          success: function (data) {\n            ////debugger\n            console.log(data);\n\n            //debugger\n            if (data.d.results.length > 0) {\n\n              thisGlobal.listGUID = data.d.results[0].ListGUID;\n              thisGlobal.navigationType = data.d.results[0].NavigationType;\n              thisGlobal.termStoreName = data.d.results[0].TermStoreName;\n              console.log(\"1- set termstoreName with value \" + data.d.results[0].TermStoreName)\n              if (thisGlobal.termStoreName == null) {\n                console.error(\"ERROR, the function getSettingsData did nto return the term store name from global nav list ! Did you deploy global nav list ?\")\n              }\n              thisGlobal.termStoreGUID = data.d.results[0].TermStoreGUID;\n              thisGlobal.homeBtnTitle = data.d.results[0].HomeBtnTitle;\n              thisGlobal.homeBtnUrl = data.d.results[0].HomeBtnUrl;\n              thisGlobal.isCentralResource = data.d.results[0].CentralResource;\n              //Backup Data in session.Storage\n              sessionStorage.setItem(\"listGUID\", thisGlobal.listGUID);\n              sessionStorage.setItem(\"navigationType\", thisGlobal.navigationType);\n              sessionStorage.setItem(\"termStoreName\", thisGlobal.termStoreName);\n              sessionStorage.setItem(\"termStoreGUID\", thisGlobal.termStoreGUID);\n              sessionStorage.setItem(\"homeBtnTitle\", thisGlobal.homeBtnTitle);\n              sessionStorage.setItem(\"homeBtnUrl\", thisGlobal.homeBtnUrl);\n              sessionStorage.setItem(\"isCentralResource\", thisGlobal.isCentralResource);\n              resolve();\n            }\n          },\n          error: function (err) {\n            //debugger\n            if (typeof console === \"object\") {\n              console.log(\"getSettingsData - ajax :\" + err);\n            }\n            resolve();\n          }\n        });\n      } catch (e) {\n        if (typeof console === \"object\") {\n          console.log(\"getSettingsData function:\" + e);\n        }\n        resolve();\n      }\n    });\n  }\n  /**\n   * Load data from sessionStorage\n   *\n   */\n  private loadSessionStorage(): void {\n    if (typeof (Storage) !== \"undefined\") {\n      if (sessionStorage.termStoreGUID) {\n        this.termStoreGUID = sessionStorage.getItem(\"termStoreGUID\");\n      }\n      if (sessionStorage.termStoreName) {\n        this.termStoreName = sessionStorage.getItem(\"termStoreName\");\n      }\n      if (sessionStorage.navigationType) {\n        this.navigationType = sessionStorage.getItem(\"navigationType\");\n      }\n      if (sessionStorage.listGUID) {\n        this.listGUID = sessionStorage.getItem(\"listGUID\");\n      }\n      if (sessionStorage.homeBtnTitle) {\n        this.homeBtnTitle = sessionStorage.getItem(\"homeBtnTitle\");\n      }\n      if (sessionStorage.homeBtnUrl) {\n        this.homeBtnUrl = sessionStorage.getItem(\"homeBtnUrl\");\n      }\n      if (sessionStorage.isCentralResource) {\n        this.isCentralResource = sessionStorage.getItem(\"isCentralResource\");\n      }\n    } else {\n      // Sorry! No Web Storage support..\n      if (typeof console === \"object\") {\n        console.log(\"Sorry! No Web Storage support..\");\n      }\n    }\n  }\n\n  private insertMenu(): void {\n    console.log(\"insertMenu called\");\n    var siteUrl = \"\";\n    if (this.isCentralResource == \"true\") {\n      siteUrl = this.homeBtnUrl;\n    } else {\n      siteUrl = (this.spcontext.pageContext.web.absoluteUrl == \"/\") ? \"\" : this.spcontext.pageContext.web.absoluteUrl;\n    }\n\n    //debugger\n    switch (this.navigationType) {\n      case \"Menu\":\n        //Load the CSS Style sheet file of the project\n        //$('head').append(\"<link rel='stylesheet' type='text/css' href='\" + siteUrl + \"/Style Library/MIS.GlobalNavigation/css/MIS.GlobalNavigation.css'> </link>\");\n\n        //Load the Global Navigation\n        //debugger\n        let MISGlobalNavigationObject:MISGlobalNavigation = new MISGlobalNavigation();\n        MISGlobalNavigationObject.init(this.spcontext, this.termStoreName, this.termStoreGUID);\n        //init(termStoreName, termStoreGUID);//Global Navigation\n        break;\n      default: //Error in the configuration, nothing is done\n    }\n  }\n\n  //});\n  // }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/extensions/spfxToastr/MISMain.ts","\nfunction createDelegate(instance: any, method: any): any {\n  return function () {\n    return method.apply(instance, arguments);\n  }\n}\n\nexport class MISGlobalNavigation {\n  /**\n  * Global Variable of the Menu\n  *\n  */\n\n  //var treeNav = [];\n  //var htmlStr = \"<ul id='mis-nav' class='hidden'>\";\n\n  /**\n  * Create the HTML dom of the menu - Only 3 level of menu\n  *\n  * @param {string} menuItem - represents a item of the menu (this.MenuItem)\n  */\n\n  public viewModelObj: ViewModel;\n\n  constructor() {\n    this.viewModelObj = new ViewModel();\n    sessionStorage.clear();\n  }\n\n  /**\n  * Create the HTML dom of the menu - Only 3 level of menu\n  *\n  * @param {string} menuItem - represents a item of the menu (this.MenuItem)\n  * @param {int} nLevel - Level of the menu: 0, 1 or 2\n  */\n  private printTree(menuItem: MenuItem, nLevel) {\n    console.log(\"printTree()\");\n    var nbChild = menuItem.children.length;\n\n    switch (nLevel) {\n      case 0: //Top Level => Executive, Core Processes, Support or Social\n        this.viewModelObj.htmlStr += \"<div class='separator-megamenu mis-hidden'></div>\";\n        this.viewModelObj.htmlStr += \"<div class='container-megamenu'>\";\n        //this.viewModelObj.htmlStr + \"<a href='\" + menuItem.url + \"'>\" + menuItem.name + \"</a>\";\n        this.viewModelObj.htmlStr += \"<p class='menu-level1'>\" + menuItem.name;\n        this.viewModelObj.htmlStr += \"<img class='icon-level1' align='right' src='\" + this.viewModelObj.siteUrl + \"/Style Library/MIS.GlobalNavigation/images/icon-\" + menuItem.name.replace(/[~#%&*:<>?/\\{|}.]/g, \"-\") + \".png'></img>\";\n        this.viewModelObj.htmlStr += \"</p>\";\n        this.viewModelObj.htmlStr += \"<ul class='subs mis-hidden' style='list-style: none;'>\";\n\n        for (var i = 0; i < nbChild; i++) {\n          this.printTree(menuItem.children[i], nLevel + 1);\n        }\n        this.viewModelObj.htmlStr += \"</ul>\";\n        this.viewModelObj.htmlStr += \"</div>\";\n        break;\n      case 1: // Header sub Menu\n        if (menuItem.url === undefined) {\n          this.viewModelObj.htmlStr += \"<li><p class='menu-level2'>\" + menuItem.name + \"</p>\";\n        }\n        else {\n          this.viewModelObj.htmlStr += \"<li><a href='\" + menuItem.url + \"'>\" +\n            menuItem.name +\n            \"<span>\" +\n            /*\"<img class='callout' src='/Style Library/MIS.GlobalNavigation/images/callout.gif' />\" +\n            menuItem.description +*/\n            \"</span>\" +\n            \"</a>\";\n        }\n        this.viewModelObj.htmlStr += \"<ul style='list-style: none;'>\";\n        for (var i = 0; i < nbChild; i++) {\n          this.printTree(menuItem.children[i], nLevel + 1);\n        }\n        this.viewModelObj.htmlStr += \"</ul>\";\n        this.viewModelObj.htmlStr += \"</li>\";\n        break;\n      case 2: // sub-sub Menu\n        this.viewModelObj.htmlStr += \"<li>\";\n        if (menuItem.url === undefined) {\n          console.log(\"cas 2 display menuITem.name\" + menuItem.name);\n          this.viewModelObj.htmlStr += menuItem.name;\n\n        }\n        else {\n\n          this.viewModelObj.htmlStr += \"<a href='\" + menuItem.url + \"'>\" + menuItem.name + \"</a>\";\n        }\n        this.viewModelObj.htmlStr += \"</li>\";\n        break;\n      //We doesn't go deep in the Navigation because we display only 3 levels of navigation\n      default: //Should not go in this case\n        this.viewModelObj.htmlStr += \"<!--Level: \" + nLevel + \" <a href='\" + menuItem.url + \"'>\" + menuItem.name + \"</a>-->\";//For the debug\n    }\n  }\n\n  /**\n  * Build the tree\n  *\n  */\n  private buildTree() {\n    console.log(\"buildTree()\");\n    this.treeFromArray2(this.viewModelObj.globalMenuItems);//Load the treeNav\n    console.log(\"entries in globalMenuItems  \" + this.viewModelObj.globalMenuItems.length)\n    for (var i = 0; i < this.viewModelObj.treeNav.length; i++) {\n      this.printTree(this.viewModelObj.treeNav[i], 0);\n    }\n    //Add the last separator in the menu\n    this.viewModelObj.htmlStr += \"<div class='separator-megamenu mis-hidden'></div>\";\n\n    //BackUp viewMenuModel in the sessionStorage\n    var viewMenuModel_json = JSON.stringify(this.viewModelObj);\n    sessionStorage.setItem(\"viewMenuModel\", viewMenuModel_json);\n  };\n\n  /**\n  * Loop on the Array globalMenuItems to create a Tree\n  *\n  */\n  private treeFromArray(list, idAttr, parentAttr, childrenAttr) {\n    console.log(\"treeFromArray()\");\n    if (!idAttr) idAttr = '_id';\n    if (!parentAttr) parentAttr = 'sonOf';\n    if (!childrenAttr) childrenAttr = 'children';\n    var treeList = [];\n    var lookup = {};\n    $.each(list, function (index, obj) {\n      lookup[obj[idAttr]] = obj;\n      obj[childrenAttr] = [];\n    });\n    $.each(list, function (index, obj) {\n      if (obj[parentAttr] != null) {\n        lookup[obj[parentAttr]][childrenAttr].push(obj);\n      } else {\n        treeList.push(obj);\n      }\n    });\n    //Sort the treeList\n    for (var i = 0; i < treeList.length; i++) {\n      treeList[i] = this.sortTermsFromTree(treeList[i]);\n    }\n    this.viewModelObj.treeNav = treeList; //Save the tree in the global variable treeNav\n\n  };\n\n  private treeFromArray2(list) {\n    console.log(\"treeFromArray2()\");\n    var idAttr = '_id';\n    var parentAttr = 'sonOf';\n    var childrenAttr = 'children';\n    var treeList = [];\n    var lookup = {};\n    $.each(list, function (index, obj) {\n      lookup[obj[idAttr]] = obj;\n      obj[childrenAttr] = [];\n    });\n    $.each(list, function (index, obj) {\n      if (obj[parentAttr] != null) {\n        lookup[obj[parentAttr]][childrenAttr].push(obj);\n      } else {\n        treeList.push(obj);\n      }\n    });\n    //Sort the treeList\n    for (var i = 0; i < treeList.length; i++) {\n      treeList[i] = this.sortTermsFromTree(treeList[i]);\n    }\n    this.viewModelObj.treeNav = treeList; //Save the tree in the global variable treeNav\n\n  };\n\n  /**\n   * Sort children array of a term tree by a sort order\n   *\n   * @param {obj} tree The term tree\n   * @return {obj} A sorted term tree\n   */\n\n  private sortTermsFromTree(tree) {\n    console.log(\"sortTermsFromTree()\");\n    // Check to see if the get_customSortOrder function is defined. If the term is actually a term collection,\n    // there is nothing to sort.\n    if (tree.children.length && tree.customSortOrder) {\n      var sortOrder = null;\n\n      if (tree.customSortOrder) {\n        sortOrder = tree.customSortOrder;\n      }\n\n      // If not null, the custom sort order is a string of GUIDs, delimited by a :\n      if (sortOrder) {\n        sortOrder = sortOrder.split(':');\n\n        tree.children.sort(function (a, b) {\n          var indexA = sortOrder.indexOf(a.guid);\n          var indexB = sortOrder.indexOf(b.guid);\n\n          if (indexA > indexB) {\n            return 1;\n          } else if (indexA < indexB) {\n            return -1;\n          }\n\n          return 0;\n        });\n      }\n      // If null, terms are just sorted alphabetically\n      else {\n        tree.children.sort(function (a, b) {\n          if (a.name > b.name) {\n            return 1;\n          } else if (a.name < b.name) {\n            return -1;\n          }\n\n          return 0;\n        });\n      }\n    }\n\n    for (var i = 0; i < tree.children.length; i++) {\n      tree.children[i] = this.sortTermsFromTree(tree.children[i]);\n    }\n\n    return tree;\n  };\n\n  /**\n  * Generate the html dom of the navigation\n  *\n  */\n  private displayMenu() {\n    console.log(\"displayMenu called\");\n    ////var homeBtnTitle, homeBtnUrl, isCentralResource;\n\n    if (!sessionStorage.viewMenuModel) {\n      this.buildTree();\n    }\n\n    //Add link to Home page\n\n\n    //Add link to Home page\n    var menuInnerHtml =\n      \"<div id='nav-container'>\" +\n      this.viewModelObj.htmlStr +\n      \"</div>\";\n    console.log(menuInnerHtml);\n\n    //Insert icon on the left of the SharePoint text (Top left corner) + all menu html\n    $('#MEGAMENU').append(menuInnerHtml);\n    this.applyNavigationEvent();\n  };\n\n  //Event on the Menu\n  private applyNavigationEvent() {\n\n    this.bindHoverMenu();\n\n\n    //Apply event on the menu\n    //#homeBtn:hover  #nav-container\n    // $(\"#MEGAMENU\").on('click', function () {\n    //   $(\"#MEGAMENU\").toggleClass(\"mis-on\");\n    //   $('#nav-container').toggleClass(\"mis-on\");\n    //   //$(\"nav ul\").toggleClass('mis-hidden');\n    // });\n\n    $(\"#MEGAMENU img\")\n      .mouseover(function () {\n        var src = $(this).attr(\"src\").replace(\"menu.png\", \"menuover.png\");\n        $(this).attr(\"src\", src);\n      })\n      .mouseout(function () {\n        var src = $(this).attr(\"src\").replace(\"over.png\", \".png\");\n        $(this).attr(\"src\", src);\n      });\n\n  };\n\n  private bindHoverMenu() {\n    //get every hidden menus\n    var hiddenMenu = $('.mis-hidden');\n\n    //on hover menu level, show the menu, on hover off, hide the menu\n    $(\"#nav-container\").hover(function () {\n      hiddenMenu.removeClass(\"mis-hidden\");\n    }, function () {\n      hiddenMenu.addClass(\"mis-hidden\");\n    });\n  }\n\n  /**\n  * Return a string name of the term's parent and null if no parent\n  *\n  * @param {string} sPath - Path of the term: \"Level1;SubLevel1-1;Term\"\n  * @param {bool} isRoot - true if the term is root\n  */\n  private getParentTerm(sPath, isRoot) {\n    var termParentName;\n    if (isRoot)\n      termParentName = null;\n    else {\n      var arrayTerm = sPath.split(\";\");\n      var indParent = 0;\n      if (arrayTerm.length > 1)\n        indParent = arrayTerm.length - 2;\n      termParentName = arrayTerm[indParent];\n    }\n\n    return termParentName;\n  };\n\n  /**\n   * Load data from sessionStorage\n   *\n   */\n  private loadSessionStorage(spcontext: any) {\n    if (typeof (Storage) !== \"undefined\") {\n      // Code for localStorage/sessionStorage.\n      if (sessionStorage.viewMenuModel) {\n        var viewMenuModel_json = sessionStorage.getItem(\"viewMenuModel\");\n        this.viewModelObj = JSON.parse(viewMenuModel_json);\n      }\n      if (sessionStorage.isCentralResource) {\n        this.viewModelObj.isCentralResource = (sessionStorage.getItem(\"isCentralResource\") == \"true\") ? true : false;\n      }\n      if (sessionStorage.homeBtnUrl) {\n        if (this.viewModelObj.isCentralResource) {\n          this.viewModelObj.siteUrl = sessionStorage.getItem(\"homeBtnUrl\");\n        }\n        else {\n          this.viewModelObj.siteUrl = (spcontext.pageContext.web.absoluteUrl == \"/\") ? \"\" : spcontext.pageContext.web.absoluteUrl;\n        }\n      }\n      if (sessionStorage.homeBtnTitle) {\n        this.viewModelObj.homeBtnTitle = sessionStorage.getItem(\"homeBtnTitle\");;\n      }\n\n    } else {\n      // Sorry! No Web Storage support..\n      if (typeof console === \"object\") {\n        console.log(\"Sorry! No Web Storage support..\");\n      }\n    }\n  };\n\n  /**\n   * Initialisation to get information from the TermStore\n   *\n   * @param {string} termStoreName - Name of the term store service : 'Service de métadonnées gérées'\n   * @param {object} callback - Callback function to call upon completion and pass termset into\n   */\n  public init(spcontext, termStoreName, termSetId) {\n    console.log(\"init called\");\n    //Load sessionStorage\n\n\n    this.loadSessionStorage(spcontext);\n\n    //Load all terms  if not already done.\n    //if (!this.viewModelObj.globalMenuItems) {\n    console.log(\"no terms loading it\");\n\n    this.buildTermsModel(spcontext, termStoreName, termSetId).then(() => {\n      //to do rendre asynchrone\n      //setTimeout(()=>{}, 2000);\n      this.displayMenu();\n    })\n\n    //ko.applyBindings(this.viewModelObj);\n    // SP.UI.Notify.removeNotification(nid);\n    // }), Function.createDelegate(this, function (sender, args) {\n    //    console.log('The following error has occured while loading global navigation: ' + args.get_message());\n    //  }));\n    // }));\n    //  }, 'core.js');\n    // }\n    // else {\n    //  this.displayMenu();\n    //}\n  };\n\n  private buildTermsModel(spcontext: any, termStoreName: any, termSetId: any): Promise<void> {\n    //SP.SOD.executeOrDelayUntilScriptLoaded(function () {\n    // 'use strict';\n    // var nid = SP.UI.Notify.addNotification(\"<img src='/_layouts/15/images/loadingcirclests16.gif?rev=23' style='vertical-align:bottom; display:inline-block; margin-\" + (document.documentElement.dir == \"rtl\" ? \"left\" : \"right\") + \":2px;' />&nbsp;<span style='vertical-align:top;'>Loading navigation...</span>\", false);\n    //  SP.SOD.registerSod('sp.taxonomy.js', SP.Utilities.Utility.getLayoutsPageUrl('sp.taxonomy.js'));\n    // SP.SOD.executeFunc('sp.taxonomy.js', false, Function.createDelegate(this, function () {\n    let globalThis = this;\n    return new Promise<void>((resolve, reject) => {\n      const context: SP.ClientContext = new SP.ClientContext(spcontext.pageContext.web.absoluteUrl);\n      //var context = SP.ClientContext.get_current();\n      var taxonomySession = SP.Taxonomy.TaxonomySession.getTaxonomySession(context);\n      var termStore = taxonomySession.get_termStores().getByName(termStoreName);\n      var termSet = termStore.getTermSet(termSetId);\n      var terms = termSet.getAllTerms();\n      context.load(terms);\n      //context.executeQueryAsync(function name(sender, args) {\n      context.executeQueryAsync(createDelegate(this, function (sender, args) {\n        var termsEnumerator = terms.getEnumerator();\n        resolve();\n        while (termsEnumerator.moveNext()) {\n          var currentTerm = termsEnumerator.get_current();\n          var termIsRoot = currentTerm.get_isRoot();\n          var termParentName = this.getParentTerm(currentTerm.get_pathOfTerm(), termIsRoot);\n          globalThis.viewModelObj.globalMenuItems.push(new MenuItem(currentTerm.get_name(), //title\n            currentTerm.get_localCustomProperties()['_Sys_Nav_SimpleLinkUrl'], //url\n            termIsRoot, //currentTerm.get_isRoot(),//isRoot\n            currentTerm.get_customSortOrder(), //customSortOrder\n            termParentName, //currentTerm.get_localCustomProperties()['sonOf']//sonOf\n            currentTerm.get_id().toString(), //guid of the term\n            currentTerm.get_localCustomProperties()['description']));\n          console.log(\"Push in globalMenuItems \" + currentTerm.get_name());\n          // }\n        }\n        console.log(\"GlobalMenuItems\" + globalThis.viewModelObj.globalMenuItems.length);\n        //Call the logical function to display the menu\n      }));\n\n\n    });\n  }\n}\n\n/**\n  * Represent an item of the menu\n  *\n  */\nexport class MenuItem {\n\n  name;\n  _id;\n  title;\n  url;\n  customSortOrder;\n  isRoot;\n  children;\n  customSortOrde;\n  sonOf;\n  guid;\n  description;\n\n  constructor(title, url, isRoot, customSortOrder, sonOf, guid, description) {\n    this.name = title;\n    this._id = title;\n    this.guid = guid;\n    this.url = url;\n    this.isRoot = isRoot;\n    this.customSortOrder = customSortOrder;\n    this.sonOf = sonOf;\n    this.children = [];\n    this.description = description;\n  }\n}\n\nexport class ViewModel {\n  public globalMenuItems: Array<any>; //Contain all the Navigation termset with set of Title, url, isRoot, parent, sonOf\n  public treeNav: Array<any>;\n  public htmlStr: any;\n  public isCentralResource: boolean;\n  public siteUrl: any;\n  public homeBtnTitle: any;\n\n  constructor() {\n    this.htmlStr = \"<ul id='mis-nav'>\";\n    this.globalMenuItems = new Array<any>();\n    this.treeNav = new Array<any>();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../../../src/extensions/spfxToastr/MISGlobalNavigation.ts","module.exports = __WEBPACK_EXTERNAL_MODULE_7__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jquery\"\n// module id = 7\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_8__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sp-init\"\n// module id = 8\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_9__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"microsoft-ajax\"\n// module id = 9\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_10__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sp-runtime\"\n// module id = 10\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_11__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sharepoint\"\n// module id = 11\n// module chunks = 0"],"sourceRoot":""}