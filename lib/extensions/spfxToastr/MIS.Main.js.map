{"version":3,"sources":["extensions/spfxToastr/MIS.Main.ts"],"names":[],"mappings":"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","file":"extensions/spfxToastr/MIS.Main.js","sourcesContent":["export default class MISMain {\n\n  private static init() {\n\n    var listGUID,\n      navigationType, //'Menu' or 'Wiki'\n      termStoreGUID,\n      termStoreName,//Service de métadonnées gérées\n      homeBtnTitle,\n      homeBtnUrl,\n      isCentralResource;\n    function getMenuParameters(): void {\n      console.log(\"getMenuParameters called\");\n      try {\n        loadSessionStorage();\n        if (termStoreGUID == undefined && termStoreName == undefined) {\n          //var url = _spPageContextInfo.webAbsoluteUrl;\n          var url = (this.context.pageContext.web.absoluteUrl == \"/\") ? \"\" : this.context.pageContext.web.absoluteUrl;\n          getSettingsData(url);//Call GlobalNavigation settings data\n\n          if (isCentralResource == true && url != homeBtnUrl) {\n            getSettingsData(homeBtnUrl);//Call GlobalNavigation settings data in the Central ressource url\n          }\n        }\n        //Insert the menu in the top navigation\n        insertMenu();\n      }\n      catch (e) {\n        if (typeof console === \"object\") {\n          console.log(\"getMenuParameters function:\" + e);\n        }\n      }\n\n    }\n    /**\n     * Load data from List GlobalNavigation URL and update the sessionStorage\n     *\n     */\n    function getSettingsData(url) {\n      try {\n        var requestUri = url + \"/_api/web/lists/getByTitle('GlobalNavigation')/Items?$filter=isActif eq 1\";\n        // execute AJAX request synchrone\n        $.ajax({\n          url: requestUri,\n          type: \"GET\",\n          headers: { \"ACCEPT\": \"application/json;odata=verbose\" },\n          async: false, //synchrone request\n          success: function (data) {\n            if (data.d.results.length > 0) {\n              listGUID = data.d.results[0].ListGUID;\n              navigationType = data.d.results[0].NavigationType;\n              termStoreName = data.d.results[0].TermStoreName;\n              termStoreGUID = data.d.results[0].TermStoreGUID;\n              homeBtnTitle = data.d.results[0].HomeBtnTitle;\n              homeBtnUrl = data.d.results[0].HomeBtnUrl;\n              isCentralResource = data.d.results[0].CentralResource;\n              //Backup Data in session.Storage\n              sessionStorage.setItem(\"listGUID\", listGUID);\n              sessionStorage.setItem(\"navigationType\", navigationType);\n              sessionStorage.setItem(\"termStoreName\", termStoreName);\n              sessionStorage.setItem(\"termStoreGUID\", termStoreGUID);\n              sessionStorage.setItem(\"homeBtnTitle\", homeBtnTitle);\n              sessionStorage.setItem(\"homeBtnUrl\", homeBtnUrl);\n              sessionStorage.setItem(\"isCentralResource\", isCentralResource);\n            }\n          },\n          error: function (err) {\n            if (typeof console === \"object\") {\n              console.log(\"getSettingsData - ajax :\" + err);\n            }\n          }\n        });\n      }\n      catch (e) {\n        if (typeof console === \"object\") {\n          console.log(\"getSettingsData function:\" + e);\n        }\n      }\n    }\n    /**\n     * Load data from sessionStorage\n     *\n     */\n    function loadSessionStorage() {\n      if (typeof (Storage) !== \"undefined\") {\n        if (sessionStorage.termStoreGUID) {\n          termStoreGUID = sessionStorage.getItem(\"termStoreGUID\");\n        }\n        if (sessionStorage.termStoreName) {\n          termStoreName = sessionStorage.getItem(\"termStoreName\");\n        }\n        if (sessionStorage.navigationType) {\n          navigationType = sessionStorage.getItem(\"navigationType\");\n        }\n        if (sessionStorage.listGUID) {\n          listGUID = sessionStorage.getItem(\"listGUID\");\n        }\n        if (sessionStorage.homeBtnTitle) {\n          homeBtnTitle = sessionStorage.getItem(\"homeBtnTitle\");\n        }\n        if (sessionStorage.homeBtnUrl) {\n          homeBtnUrl = sessionStorage.getItem(\"homeBtnUrl\");\n        }\n        if (sessionStorage.isCentralResource) {\n          isCentralResource = sessionStorage.getItem(\"isCentralResource\");\n        }\n      } else {\n        // Sorry! No Web Storage support..\n        if (typeof console === \"object\") {\n          console.log(\"Sorry! No Web Storage support..\");\n        }\n      }\n    }\n    function insertMenu() {\n      var siteUrl = \"\";\n      if (isCentralResource == \"true\") {\n        siteUrl = homeBtnUrl;\n      }\n      else {\n        siteUrl = (_spPageContextInfo.siteServerRelativeUrl == \"/\") ? \"\" : _spPageContextInfo.siteServerRelativeUrl;\n      }\n\n      switch (navigationType) {\n        case \"Menu\":\n          //Load the CSS Style sheet file of the project\n          $('head').append(\"<link rel='stylesheet' type='text/css' href='\" + siteUrl + \"/Style Library/MIS.GlobalNavigation/css/MIS.GlobalNavigation.css'> </link>\");\n\n          //Load the Global Navigation\n          //MISGlobalNavigation.init('Service de métadonnées gérées', '1bdb0c2c-5ad5-4b03-9ee6-cd4e0a29a520');\n          //init(termStoreName, termStoreGUID);//Global Navigation\n          break;\n        default://Error in the configuration, nothing is done\n      }\n    }\n\n    $(document).ready(function () {\n      try {\n        //Remove Sharepoint text if exist SP 2013\n        $('#suiteBarLeft .ms-core-brandingText').remove();\n\n        //Contain the webapp where mysites is configured\n        var privateUrl = \"https://private.monacoinformatiqueservice.mc\";\n\n        //Change the url of the top link \"Sites\"\n        $(\"#Sites_BrandBar\").attr('href', privateUrl + '/_layouts/15/MySite.aspx?MySiteRedirect=AllSites');\n        //Change the url of the Tile \"Sites\"\n        $(\"#O365_AppTile_Sites\").attr('href', privateUrl + '/_layouts/15/MySite.aspx?MySiteRedirect=AllSites');\n        //Change the url of the Tile \"OneDrive\"\n        //$(\"#O365_AppTile_Documents\").attr('href', privateUrl+'/_layouts/15/MySite.aspx?MySiteRedirect=AllDocuments');\n        //Change the url of the Tile \"Flux d'actualité\"\n        $(\"#O365_AppTile_Newsfeed\").attr('href', privateUrl + '/_layouts/15/MySite.aspx');\n\n        //20171002 - Change Sites link, Jeff ANGAMA\n        //$('#ShellSites_BrandBar').remove(); //id du privee\n        //$('#Sites_BrandBar').remove(); //id du public\n        $('#ShellSites_BrandBar').attr('href', privateUrl + '/_layouts/15/MySite.aspx?MySiteRedirect=AllSites');\n        //hide sharepoint text\n        $('.o365cs-nav-appTitleLine').hide();\n        $('.o365cs-nav-brandingText:first').text(\"\");\n\n        //To be sure\n        //SP.SOD.registerSod(\"sp.js\", \"/\" + _spPageContextInfo.layoutsUrl + \"/sp.js\");\n        //SP.SOD.executeFunc('sp.js', false, function () { });\n\n        ExecuteOrDelayUntilScriptLoaded(getMenuParameters, \"sp.js\");\n        //SP.SOD.executeOrDelayUntilScriptLoaded(MIS.SiteCollection.execute, \"sp.ui.pub.ribbon.js\");\n      }\n      catch (ex) {\n        //console.log(\"$(document).ready\" + ex);\n        if (typeof console === \"object\") {\n          console.log(\"$(document).ready\" + ex);\n        }\n        else {\n          alert(\"$(document).ready\" + ex);\n        }\n      }\n    });\n  }\n}\n"],"sourceRoot":"..\\..\\..\\src"}